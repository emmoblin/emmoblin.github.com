
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Emmoblin Blog</title>
  <meta name="author" content="emmoblin">

  
  <meta name="description" content="">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://emmoblin.github.com/blog/page/2">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/bootstrap/bootstrap.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/bootstrap/responsive.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/syntax/syntax.css" media="screen, projection" rel="stylesheet" type="text/css">
  <style type="text/css">
    body {
      padding-bottom: 40px;
    }
    h1 {
      margin-bottom: 15px;
    }
    img {
      max-width: 100%;
    }
    .sharing, .meta, .pager {
      margin: 20px 0px 20px 0px;
    }
    .page-footer p {
      text-align: center;
    }
  </style>
  <script src="/javascripts/libs/jquery.js"></script>
  <script src="/javascripts/libs/modernizr-2.0.js"></script>
  <script src="/javascripts/libs/bootstrap.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Emmoblin Blog" type="application/atom+xml">
  
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-34538597-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <nav role="navigation"><div class="navbar">
  <div class="navbar-inner">
    <div class="container">
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>

      <a class="brand" href="/">Emmoblin Blog</a>

      <div class="nav-collapse">
        <ul class="nav">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>


        <ul class="nav pull-right" data-subscription="rss">
          <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
          
        </ul>

        
          <form class="pull-right navbar-search" action="http://google.com/search" method="get">
            <fieldset role="search">
              <input type="hidden" name="q" value="site:emmoblin.github.com" />
              <input class="search-query" type="text" name="q" results="0" placeholder="Search"/>
            </fieldset>
          </form>
        
      </div>
    </div>
  </div>
</div>
</nav>
  <div class="container">
    <div class="row-fluid">
      <div class="span9">
  
  
  
    <article>
      
  <header class="page-header">
    
      <h1 class="entry-title"><a href="/blog/2013/03/17/expect/">Expect自动ssh登录</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-03-17T00:00:00+08:00" pubdate data-updated="true">2013年03月17日</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div><div><p><br/>
</p>
</div>

<div id="outline-container-1-1" class="outline-3">
<h3 id="sec-1-1">自动ssh的expect脚本</h3>
<div class="outline-text-3" id="text-1-1">


<p><br/>
<pre class="src src-sh"><span style="color: #8c8c8c; font-style: italic;">#</span><span style="color: #8c8c8c; font-style: italic;">!/usr/bin/</span><span style="color: #0000ff;">expect</span><span style="color: #8c8c8c; font-style: italic;"> </span>
<span style="color: #a52a2a;">set</span> timeout 5
<span style="color: #a52a2a;">set</span> cmd_prompt <span style="color: #00bfff;">"]#|~]?"</span>
<span style="color: #a52a2a;">set</span> server [lindex $<span style="color: #ff1493;">argv</span> 0] 
<span style="color: #a52a2a;">set</span> user [lindex $<span style="color: #ff1493;">argv</span> 1] 
<span style="color: #a52a2a;">set</span> passwd [lindex $<span style="color: #ff1493;">argv</span> 2] 

spawn ssh -l $<span style="color: #ff1493;">user</span> $<span style="color: #ff1493;">server</span> 
expect { 
<span style="color: #00bfff;">"(yes/no)"</span> { send <span style="color: #00bfff;">"yes\r"</span>; exp_continue } 
<span style="color: #00bfff;">"password:"</span> { send <span style="color: #00bfff;">"$passwd\r"</span> } 
}
<span style="color: #8c8c8c; font-style: italic;">#</span><span style="color: #8c8c8c; font-style: italic;">expect "$cmd_prompt" interact</span>
expect <span style="color: #00bfff;">"*Last login*"</span> interact
</pre>



</p></div>
</div>
</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header class="page-header">
    
      <h1 class="entry-title"><a href="/blog/2013/03/12/nfs-server/">NFS Server</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-03-12T00:00:00+08:00" pubdate data-updated="true">2013年03月12日</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">NFS server</a>
<ul>
<li><a href="#sec-1-1">开启nfs-server和client</a>
<ul>
<li><a href="#sec-1-1-1">server端</a>
<ul>
<li><a href="#sec-1-1-1-1">exportfs</a></li>
</ul>
</li>
<li><a href="#sec-1-1-2">client端</a></li>
<li><a href="#sec-1-1-3">nfs卡住问题</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1"><a href="http://emmoblin.github.com/blog/2013/03/12/nfs-server/">NFS server</a></h2>
<div class="outline-text-2" id="text-1">


<p><br/>
</p>
</div>

<div id="outline-container-1-1" class="outline-3">
<h3 id="sec-1-1">开启nfs-server和client</h3>
<div class="outline-text-3" id="text-1-1">

<p>fc18上启动nfs真是比较麻烦，server和client端都需要启动好几个服务，所以需要特别记录一下。<br/>
</p>
<p><br/>
</p>
</div>

<div id="outline-container-1-1-1" class="outline-4">
<h4 id="sec-1-1-1">server端</h4>
<div class="outline-text-4" id="text-1-1-1">


<p><br/>
<pre class="example">[root@dlp ~]# vi /etc/idmapd.conf 
# line 5: uncomment and change to your domain name
Domain = server.world 
[root@dlp ~]# vi /etc/exports 
# write like below *note
/home 10.0.0.0/24(rw,sync,no_root_squash,no_all_squash)
</pre>


/home 表示目录<br/>
ip  允许访问的子网，*代表所有<br/>
no_root_squash:对于登陆NFS主机的共享目录用户如果是root的话则对该目录具有root权限。建议不用为好！<br/>
root_squash:对于登陆NFS主机的共享目录用户使用者如果是root则它的权限将被压缩成匿名使用者，<br/>
同时它的UID和GID都会变成nobody那个系统账号的身份。<br/>
all_squash:不管登陆NFS主机用户身份如何，它的身份都会被压缩成匿名使用者，通常就是nobody<br/>
anonuid:anonuid=xxx,制定NFS服务器/etc/passwd中匿名用户的UID<br/>
anongid:anonuid=xxx,制定NFS服务器/etc/passwd中匿名用户的GID<br/>
sync:数据在请求时写入共享<br/>
async:NFS在写入数据前可响应请求<br/>
secure:NFS通过1024以下的安全端口发送<br/>
insecure:NFS通过1024以上端口发送<br/>
hide:不共享NFS目录的子目录<br/>
no_hide:共享NFS目录的子目录<br/>
</p>
<p><br/>
</p>
<p><br/>
<pre class="src src-sh">[root@dlp ~]# systemctl start rpcbind.service 
[root@dlp ~]# systemctl start nfs-server.service 
[root@dlp ~]# systemctl start nfs-lock.service 
[root@dlp ~]# systemctl start nfs-idmap.service 
[root@dlp ~]# systemctl enable rpcbind.service 
[root@dlp ~]# systemctl enable nfs-server.service 
[root@dlp ~]# systemctl enable nfs-lock.service 
[root@dlp ~]# systemctl enable nfs-idmap.service
</pre>


 最终要的还要关闭防火墙：<br/>
 systemctl disable firewalld.service<br/>
</p>
<p><br/>
</p>
</div>

<div id="outline-container-1-1-1-1" class="outline-5">
<h5 id="sec-1-1-1-1">exportfs</h5>
<div class="outline-text-5" id="text-1-1-1-1">

<p>exportfs [-aruv]<br/>
 -a:全部挂载(或卸载) /etc/exports文件设定<br/>
 -r:重新挂载 /etc/exports设定,也可以同步更新/etc/exports设定<br/>
 -u:卸载某一目录<br/>
 -v:在export时,将共享目录显示在屏幕上<br/>
</p>
<p><br/>
showmount -a<br/>
在NFS Server上显示已经mount上本机NFS目录的Client机器。<br/>
</p>
<p><br/>
</p></div>
</div>

</div>

<div id="outline-container-1-1-2" class="outline-4">
<h4 id="sec-1-1-2">client端</h4>
<div class="outline-text-4" id="text-1-1-2">


<p><br/>
<pre class="example">[root@www ~]# vi /etc/idmapd.conf 
# line 5: uncomment and change to your domain name
 Domain = server.world 
 [root@www ~]# systemctl start rpcbind.service 
 [root@www ~]# systemctl start nfs-lock.service 
 [root@www ~]# systemctl start nfs-idmap.service 
 [root@www ~]# systemctl start nfs-mountd.service 
 [root@www ~]# systemctl enable rpcbind.service 
 [root@www ~]# systemctl enable nfs-lock.service 
 [root@www ~]# systemctl enable nfs-idmap.service 
 [root@www ~]# systemctl enable nfs-mountd.service 
 [root@www ~]# mount -t nfs dlp.server.world:/home /home 
 [root@www ~]# df -h 
Filesystem               Size  Used Avail Use% Mounted on
devtmpfs                 992M     0  992M   0% /dev
tmpfs                   1002M     0 1002M   0% /dev/shm
tmpfs                   1002M  1.5M 1001M   1% /run
tmpfs                   1002M     0 1002M   0% /sys/fs/cgroup
/dev/mapper/fedora-root   16G  1.2G   14G   8% /
tmpfs                   1002M     0 1002M   0% /tmp
/dev/vda1                485M   71M  389M  16% /boot
dlp.server.world:/home    16G  1.2G   14G   8% /home
# home directory on NFS is mounted 
 [root@www ~]# vi /etc/fstab 
/dev/mapper/VolGroup-lv_root /                       ext4    defaults  1 1
UUID=65ec32e2-f459-4d63-b8b0-e18124b50f3a /boot      ext4    defaults  1 2
/dev/mapper/VolGroup-lv_swap swap                    swap    defaults  0 0
# add at the lat line: change home directory this server mounts to the one on NFS
dlp.server.world:/home /home                         nfs     defaults  0 0

</pre>

</p></div>

</div>

<div id="outline-container-1-1-3" class="outline-4">
<h4 id="sec-1-1-3">nfs卡住问题</h4>
<div class="outline-text-4" id="text-1-1-3">

<p>如果服务端意外停止，在客户机上使用 ls，df等磁盘查看命令时，会卡住，并且ctrl+c都不能强制退出。<br/>
原因是默认的mount是“硬”挂载，会不断的重试。解决办法是：<br/>
1、mount的时候加上 -s 参数，作为“软”挂载<br/>
2、umount -f /xxxxx/xxxx 用这个命令来取消挂载。<br/>
如果出现device busy的错误，说明还有进程在使用该挂载点，要把进程停了，才能umount<br/>
</p>
<p><br/>
通过试验发现，这几个方法都不管用。依然一断网就会挂住。<br/>
</p></div>
</div>
</div>
</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header class="page-header">
    
      <h1 class="entry-title"><a href="/blog/2013/03/11/xclip/">Xlicp在命令行下使用剪切板</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-03-11T00:00:00+08:00" pubdate data-updated="true">2013年03月11日</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div><div><p><br/>
</p>
</div>

<div id="outline-container-1-1" class="outline-3">
<h3 id="sec-1-1">xlicp在命令行下使用剪切板</h3>
<div class="outline-text-3" id="text-1-1">

<p>一、安装xclip<br/>
ubuntu下的用户可以只用apt-get来安装：<br/>
</p>
<p><br/>
sudo apt-get install xclip<br/>
其他发行版的用户可以选择自己的安装方式，也可以用源码编译安装，xclip项目的主页是：<a href="http://sourceforge.net/projects/xclip/">http://sourceforge.net/projects/xclip/</a><br/>
</p>
<p><br/>
二、使用<br/>
xclip可以将内容输出到‘X’的剪切板中，比如：<br/>
</p>
<p><br/>
echo &#8220;Hello, world&#8221; | xclip<br/>
执行这个命令后你就可以用鼠标中键来在X程序中将内容粘贴出来。但是更多的时候，我们需要不仅仅把内容输出到‘X’的剪切板中，而是希望可以在GUI程序中用ctrl + v也可以粘贴（比如，输出到gnome的剪切板中），下面这段命令就可以让你将内容输出到gnome的剪切板中：<br/>
</p>
<p><br/>
echo &#8220;Hello, world&#8221; | xclip -selection clipboard<br/>
再在一个GUI程序中按下ctrl + v，看下是不是粘贴上去了呢？顺着这个命令，我也重新写了一下ifconfig，让它在执行后输入内容到终端的同时，也将ip地址输出到剪切板中，因为通常情况下，查看ifconfig就是为了获取机器的ip地址：<br/>
</p>
<p><br/>
alias ifconfig=&#8217;/sbin/ifconfig &amp;&amp; echo `/sbin/ifconfig | sed -n 2p | awk &#8220;{ print &#92;$2 }&#8221; | grep -o &#8220;[0-9]\{1,3\}&#46;[0-9]\{1,3\}&#46;[0-9]\{1,3\}&#46;[0-9]\{1,3\}&#8221;` | xclip -selection clipboard&#8217;<br/>
</p></div>
</div>
</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header class="page-header">
    
      <h1 class="entry-title"><a href="/blog/2013/03/10/zsh/">Zsh</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-03-10T00:00:00+08:00" pubdate data-updated="true">2013年03月10日</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div><div><p><br/>
</p>
</div>

<div id="outline-container-1-1" class="outline-3">
<h3 id="sec-1-1">zsh 配置</h3>
<div class="outline-text-3" id="text-1-1">


</div>

<div id="outline-container-1-1-1" class="outline-4">
<h4 id="sec-1-1-1">setopt autocd</h4>
<div class="outline-text-4" id="text-1-1-1">

<p>如果你想要避免在切换目录时一直输入乏味的cd命令（比如使用/etc而不是cd /etc）你可以设置autocd选项。<br/>
</p>
<p><br/>
</p></div>

</div>

<div id="outline-container-1-1-2" class="outline-4">
<h4 id="sec-1-1-2">PS1</h4>
<div class="outline-text-4" id="text-1-1-2">

<p>转义序列        打印效果<br/>
%T      系统时间（时：分）<br/>
%*      系统时间（时：分：秒）<br/>
%D      系统日期（年-月-日）<br/>
%n      你的用户名<br/>
%B - %b 开始到结束使用粗体打印<br/>
%U - %u 开始到结束使用下划线打印<br/>
%d      你目前的工作目录<br/>
%~      你目前的工作目录相对于～的相对路径<br/>
%M      计算机的主机名<br/>
%m      计算机的主机名（在第一个句号之前截断）<br/>
%l      你当前的tty<br/>
</p>
<p><br/>
</p></div>

</div>

<div id="outline-container-1-1-3" class="outline-4">
<h4 id="sec-1-1-3">zsh设置为默认sh</h4>
<div class="outline-text-4" id="text-1-1-3">

<p>我们可以通过usermod命令来设置某一个给定用户的shell。<br/>
</p>
<p><br/>
代码 4.1: 使用usermod命令永久地切换到zsh<br/>
usermod -s /bin/zsh userlogin<br/>
</p>
<p><br/>
或者<br/>
（使用你的用户名替代&#8221;username&#8221;）<br/>
$ chsh -s /bin/zsh username<br/>
</p>
<p><br/>
</p></div>

</div>

<div id="outline-container-1-1-4" class="outline-4">
<h4 id="sec-1-1-4">其他</h4>
<div class="outline-text-4" id="text-1-1-4">

<p>setopt AUTO_CONTINUE<br/>
</p>
<p><br/>
为了提交工作效率，可以定义一些函数或者常用的alias<br/>
f() {<br/>
    echo &#8220;find . -iname &#34;<b>$1</b>&#34;&#8221;<br/>
    find . -iname &#8221;<b>$1</b>&#8221;<br/>
}<br/>
</p>
<p><br/>
</p>
<p><br/>
autoload copy-earlier-word<br/>
zle -N copy-earlier-word<br/>
bindkey &#8216;^[,&#8217; copy-earlier-word<br/>
</p>
<p><br/>
</p>
<p><br/>
setopt AUTO_PUSHD<br/>
setopt PUSHD_IGNORE_DUPS<br/>
</p>
<p><br/>
my_accounts=(<br/>
{r00t,root}@{192.168.1.1,192.168.0.1}<br/>
kardinal@linuxtoy.org<br/>
123@211.148.131.7<br/>
)<br/>
zstyle &#8216;:completion:*:my-accounts&#8217; users-hosts $my_accounts<br/>
</p>
<p><br/>
zstyle &#8216;:completion:*:scp:*&#8217; tag-order \<br/>
   files users &#8216;hosts:-host hosts:-domain:domain hosts:-ipaddr&#8221;IP\ Address *&#8217;<br/>
zstyle &#8216;:completion:*:scp:*&#8217; group-order \<br/>
   files all-files users hosts-domain hosts-host hosts-ipaddr<br/>
zstyle &#8216;:completion:*:ssh:*&#8217; tag-order \<br/>
   users &#8216;hosts:-host hosts:-domain:domain hosts:-ipaddr&#8221;IP\ Address *&#8217;<br/>
zstyle &#8216;:completion:*:ssh:*&#8217; group-order \<br/>
   hosts-domain hosts-host users hosts-ipaddr<br/>
zstyle &#8216;*&#8217; single-ignored show<br/>
</p>
<p><br/>
</p>
<p><br/>
</p></div>

</div>

<div id="outline-container-1-1-5" class="outline-4">
<h4 id="sec-1-1-5">hash 路径别名</h4>
<div class="outline-text-4" id="text-1-1-5">

<p>hash -d blog=&#8221;/home/henryyan/work/blog/henryyan.github.com&#8221;<br/>
cd ~blog<br/>
</p>
<p><br/>
</p></div>

</div>

<div id="outline-container-1-1-6" class="outline-4">
<h4 id="sec-1-1-6">文件关联</h4>
<div class="outline-text-4" id="text-1-1-6">

<p>在图形化的文件管理器中，通常我们只要单击/双击某个文件，文件管理器就会调用相应的程序来打开该文件。<br/>
其实，这样的文件关联在 Zsh 中也可以实现。具体操作步骤如下：<br/>
添加下列内容到你的 $HOME/.zshrc 文件中：<br/>
autoload -U zsh-mime-setup<br/>
zsh-mime-setup<br/>
以关联扩展名为 png 的图像文件为例，假设要通过 pho 程序来查看，那么在 $HOME/.zshrc 中可以这样定义：<br/>
alias -s png=pho<br/>
我们以 alias 的形式来实现文件关联，其中 png 为要关联文件的扩展名，= 右边的 pho 为关联的程序。这里的 -s 必不可少。<br/>
要关联其他类型的文件，只需如法炮制即可。<br/>
为了使 .zshrc 生效，需要 source 该文件。<br/>
现在，在 Zsh 中，例如要查看 linuxtoy.png 文件，只要输入该文件名（可按 Tab 自动补完）并按回车，Zsh 便会自动调用 pho 来打开。<br/>
</p>
<p><br/>
</p></div>

</div>

<div id="outline-container-1-1-7" class="outline-4">
<h4 id="sec-1-1-7">cd扩展</h4>
<div class="outline-text-4" id="text-1-1-7">

<p>“cd ….”之类，会根据点的个数补全路径，比如 “…”补全为 “../../” ，“….”补全为 “../../..”<br/>
</p>
<p><br/>
配合我修改的 tab 键：空行 tab 出 “cd ”，自己点点点后回车，O了<br/>
</p>
<p><br/>
</p>
<p><br/>
<pre class="example">user-ret(){
    if [[ $BUFFER = "" ]] ;then
        BUFFER="ls"
        zle end-of-line
        zle accept-line
    elif [[ $BUFFER =~ "^cd\ ...+$" ]] ;then
        BUFFER=${${BUFFER//./..\/}/..\//}
        zle end-of-line
        zle accept-line
    else
        zle accept-line
    fi
}
zle -N user-ret
bindkey "\r" user-ret
</pre>

</p></div>
</div>
</div>
</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header class="page-header">
    
      <h1 class="entry-title"><a href="/blog/2013/03/06/ulimit/">Ulimit</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-03-06T00:00:00+08:00" pubdate data-updated="true">2013年03月06日</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div><div><p><br/>
</p>
</div>

<div id="outline-container-1-1" class="outline-3">
<h3 id="sec-1-1">解决too many open file的有关问题</h3>
<div class="outline-text-3" id="text-1-1">

<p>ulimit是bash的内建命令，并不是一个程序。<br/>
<code>ulimit -a</code> 查看所有设置<br/>
</p>
<p><br/>
通过ulimit -n 命令可以查看linux系统里打开文件描述符的最大值，一般缺省值是1024，对一台繁忙的服务器来说，这个值偏小，所以有必要重新设置linux系统里打开文件描述符的最大值。<br/>
</p>
<p><br/>
如果单个进程打开的文件句柄数量超过了系统定义的值，就会提到“too many files open”的错误提示。如何知道当前进程打开了多少个文件句柄呢？下面一段小脚本可以帮你查看：<br/>
</p>
<p><br/>
</p>
<p><br/>
<pre class="src src-sh">lsof -n |awk &#8216;{print $<span style="color: #ff1493;">2</span>}&#8217;|sort|uniq -c |sort -nr|more
</pre>

其中第一行是打开的文件句柄数量，第二行是进程号。<br/>
</p>
<p><br/>
Linux有硬性限制和软性限制。可以通过ulimit来设定这两个参数<br/>
<code>ulimit -HSn 4096</code><br/>
H指定了硬性大小，S指定了软性大小，n表示设定单个进程最大的打开文件句柄数量.<br/>
</p>
<p><br/>
</p></div>

</div>

<div id="outline-container-1-2" class="outline-3">
<h3 id="sec-1-2">limits.conf</h3>
<div class="outline-text-3" id="text-1-2">

<p>此修改只是临时有效，要想长期有效需要修改：/etc/security/limits.conf<br/>
在文件末尾加上：<br/>
</p>
<p><br/>
<pre class="example">* soft nofile 65536
* hard nofile 65536
</pre>


此文件还有其他的相关设置：<br/>
以下是文件描述：<br/>
</p>
<p><br/>
<pre class="example">#Each line describes a limit for a user in the form:
#
#&lt;domain&gt;  &lt;type&gt;  &lt;item&gt;  &lt;value&gt;
#
#Where:
#&lt;domain&gt; can be:
#        - an user name
#        - a group name, with @group syntax
#        - the wildcard *, for default entry
#        - the wildcard %, can be also used with %group syntax,
#                 for maxlogin limit
#
#&lt;type&gt; can have the two values:
#        - "soft" for enforcing the soft limits
#        - "hard" for enforcing hard limits
#
#&lt;item&gt; can be one of the following:
#        - core - limits the core file size (KB)
#        - data - max data size (KB)
#        - fsize - maximum filesize (KB)
#        - memlock - max locked-in-memory address space (KB)
#        - nofile - max number of open files
#        - rss - max resident set size (KB)
#        - stack - max stack size (KB)
#        - cpu - max CPU time (MIN)
#        - nproc - max number of processes
#        - as - address space limit
#        - maxlogins - max number of logins for this user
#        - maxsyslogins - max number of logins on the system
#        - priority - the priority to run user process with
#        - locks - max number of file locks the user can hold
#        - sigpending - max number of pending signals
#        - msgqueue - max memory used by POSIX message queues (bytes)
#        - nice - max nice priority allowed to raise to
#        - rtprio - max realtime priority
</pre>


</p></div>

</div>

<div id="outline-container-1-3" class="outline-3">
<h3 id="sec-1-3">ubuntu还需要修改pam</h3>
<div class="outline-text-3" id="text-1-3">

<p>对于ubuntu还需要修改pam.d配置，才能生效<br/>
</p>
<p><br/>
<pre class="example">1. sudo vi /etc/pam.d/common-session
2. Add session required pam_limits.so to the end of the file.
3. Reboot the OS.
</pre>

</p></div>
</div>
</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header class="page-header">
    
      <h1 class="entry-title"><a href="/blog/2013/03/06/difference-svn-and-cvs/">Svn与cvs的区别</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-03-06T00:00:00+08:00" pubdate data-updated="true">2013年03月06日</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div><div><p><br/>
</p>
</div>

<div id="outline-container-1-1" class="outline-3">
<h3 id="sec-1-1">版本编号方面</h3>
<div class="outline-text-3" id="text-1-1">

<p>在SVN中，新版本的版本号不是针对某个特定文件的，而是针对整个库而言的。<br/>
而cvs是对文件的版本编号。<br/>
svn的版本类似是对整个库的快照。<br/>
SVN的全局性版本编号为SVN带来了诸多的优势：如对目录或文件执行拷贝，无论涉及多少文件，SVN不需要对单个文件依次执行拷贝命令，仅仅需要建立一个指向相应的全局版本号的一个指针即可。<br/>
</p>
<p><br/>
</p></div>

</div>

<div id="outline-container-1-2" class="outline-3">
<h3 id="sec-1-2">目录的版本控制</h3>
<div class="outline-text-3" id="text-1-2">

<p>CVS只能对文件进行版本控制，不能对目录进行版本控制。<br/>
SVN将目录作为一类特殊的文件来处理。当目录中的子目录/文件被删除、重命名、或新的子目录/文件被创建时，目 录的内容将发生改变。因此，SVN象记录普通文件的修改历史一样记录对目录的修改历史，当发生文件/目录的移动、重命名或拷贝操作时，SVN能够准确记录 操作前后的历史联系。同样，像对文件的不同历史版本进行比较一样，SVN支持对目录的不同历史版本的比较，清晰展现目录的变化历史。<br/>
</p>
<p><br/>
</p></div>

</div>

<div id="outline-container-1-3" class="outline-3">
<h3 id="sec-1-3">原子性提交</h3>
<div class="outline-text-3" id="text-1-3">

<p>SVN提交文件，只有当全部文件修改都成功入库，该提交才变得有效。一旦中断，SVN将会自动执行“回滚”（rollback）操作。SVN 这种机制保证所有的修改要么全部入库生效，要么一个也不入库。由于SVN的原子性提交特性和全局版本编号方式，当提交成功完成时，一个唯一的、新的全局版 本编号产生，而提交时用户提供的日志信息与该新的版本编号关联，只进行一次存储（区别于CVS的按文件重复存储）。<br/>
而CVS则采用线性、串行的批量提交，即依次地，一个接一个地执行提交，每成功提交一个文件，该文件的一个新的版本即被记录到版本库中。但当任 何原因造成批量操作的中断时，版本库往往处于一个不一致的状态。另外，CVS即使在批量提交不发生中断时也会造成不一致：假设用户A启动一个需要较长时间 才能完成的批量提交；与此同时，用户B执行cvsupdate操作。此时，用户B很有可能得到一个不一致的更新，即用户B通过“更新”操作，得到用户A的 部分修改文件。<br/>
</p>
<p><br/>
</p></div>

</div>

<div id="outline-container-1-4" class="outline-3">
<h3 id="sec-1-4">差异化的二进制文件处理</h3>
<div class="outline-text-3" id="text-1-4">

<p>SVN每次提交后版本库中只存储相对于先前版本的差异，从而可以节省大量的存储空间。更为重要的是，当客户端需要获取新的版本 时，SVN只传输版本的差异，从而大大减少对网络带宽的消耗。<br/>
</p></div>
</div>
</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header class="page-header">
    
      <h1 class="entry-title"><a href="/blog/2013/03/02/grub-output-to-serial/">Grub重定向到串口</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-03-02T00:00:00+08:00" pubdate data-updated="true">2013年03月02日</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div><div><p><br/>
</p>
</div>

<div id="outline-container-1-1" class="outline-3">
<h3 id="sec-1-1">** grub输出到串口</h3>
<div class="outline-text-3" id="text-1-1">

<p>将GRUB输出重定向到串口(Edit /boot/grub/grub.conf)<br/>
</p>
<p><br/>
<pre class="example">serial --unit=0 --speed=115200 --word=8 --parity=no --stop=1
terminal --timeout=5 console serial
</pre>


grub引导过程中, 会将输出同时发送到终端屏幕和串口. <br/>
grub引导过程中将在终端和连接到串口的超级终端上提示Press any key to continue, <br/>
每秒钟提示一次, 共5次, 可修改menu.lst文件terminal行中的&ndash;timeout=10改变提示次数, <br/>
在这一段时间内, 可以在终端的键盘, 或者连接到串口的超级终端中按任意键进入grub选择菜单. <br/>
如果5秒内没有在终端和连接串口的超级终端上按任意键, 则grub的选择菜单将出现在console上, <br/>
如果希望默认情况下, grub选择菜单出现在串口上, 则可修改grub.conf将<br/>
console serial修改为serial console.<br/>
</p>
<p><br/>
将kernel输出信息输出到串口(编辑 /boot/grub/grub.conf 有的为menu.lst)<br/>
增加kernel引导参数如下:<br/>
</p>
<p><br/>
<pre class="example">kernel  /boot/vmlinuz-2.6.32-29 root=/dev/hda1 ro console=ttyS0,115200n8 console=tty0
</pre>


grub2的例子<br/>
修改文件/etc/default/grub<br/>
</p>
<p><br/>
<pre class="example">#显示启动菜单
#GRUB_HIDDEN_TIMEOUT=0
修改相应的变量如下：
GRUB_CMDLINE_LINUX="console=ttyS0,115200"
GRUB_TERMINAL=serial
GRUB_SERIAL_COMMAND="serial --unit=0 --speed=115200 --word=8 --parity=no --stop=1"
</pre>


</p><ol>
<li>运行命令， 更新grub<br/>
   <code>sudo update-grub</code><br/>

<p><br/>
</p></li>
<li>在/etc/init/下，创建文件ttyS0.conf：<br/>
</li>
</ol>


<p><br/>
<pre class="example"># ttyS0 - getty
start on stopped rc RUNLEVEL=[23]
stop on runlevel [!23]

respawn
exec /sbin/getty -L 115200 ttyS0 vt100
</pre>


</p><ol>
<li>查看/etc/securetty中，含有ttyS0否。没有则加上。<br/>
</li>
<li>BIOS开启串口<br/>
</li>
<li>另一台机器，联上串口线，开启teraterm,设置115200 8n1<br/>
</li>
<li>重启机器, 看到teraterm输出Linux的启动信息。<br/>
</li>
</ol>


<p><br/>
通过比较生成的grub.cfg<br/>
发现多了一个<br/>
</p>
<p><br/>
<pre class="example">terminal_output serial
terminal_input serial
</pre>

</p>
<p> <br/>
</p></div>
</div>
</div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header class="page-header">
    
      <h1 class="entry-title"><a href="/blog/2013/02/27/netcat/">Nc使用</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-02-27T00:00:00+08:00" pubdate data-updated="true">2013年02月27日</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div><div><p><br/>
</p>
</div>

<div id="outline-container-1-1" class="outline-3">
<h3 id="sec-1-1">基本使用</h3>
<div class="outline-text-3" id="text-1-1">

<p>本地监听<br/>
<code>nc -l 3333</code><br/>
远端访问<br/>
<code>nc 192.168.0.1 3333</code><br/>
</p>
<p><br/>
</p></div>

</div>

<div id="outline-container-1-2" class="outline-3">
<h3 id="sec-1-2">传送文件</h3>
<div class="outline-text-3" id="text-1-2">

<p>发送端<br/>
<code>cat backup.iso | nc -l 3333</code><br/>
接收端<br/>
<code>nc 192.168.0.1 3333 &gt; backup.iso</code><br/>
</p>
<p><br/>
显示传送进度，可以使用管道监控,pv命令<br/>
以上命令修改为：<br/>
<code>cat backup.iso | pv -b | nc -l 3333</code><br/>
<code>nc 192.168.0.1 3333 | pv -b &gt; backup.iso</code><br/>
</p>
<p><br/>
本地打包文件，传送到远端<br/>
<code>tar -czf - /etc/ | nc -l 3333</code><br/>
接收端<br/>
<code>nc 192.168.0.1 3333 | pv -b &gt; mybackup.tar.gz</code><br/>
</p>
<p><br/>
</p></div>

</div>

<div id="outline-container-1-3" class="outline-3">
<h3 id="sec-1-3">端口扫描</h3>
<div class="outline-text-3" id="text-1-3">

<p>扫描端口，并返回相关信息<br/>
<code>nc -z 192.168.0.1 80-90</code><br/>
</p>
<p><br/>
</p></div>

</div>

<div id="outline-container-1-4" class="outline-3">
<h3 id="sec-1-4">资料</h3>
<div class="outline-text-3" id="text-1-4">

<p><a href="http://www.sans.org/security-resources/sec560/netcat_cheat_sheet_v1.pdf">http://www.sans.org/security-resources/sec560/netcat\_cheat\_sheet\_v1.pdf</a><br/>
<a href="http://www.g-loaded.eu/2006/11/06/netcat-a-couple-of-useful-examples/">http://www.g-loaded.eu/2006/11/06/netcat-a-couple-of-useful-examples/</a><br/>
</p>
<p><br/>
</p></div>
</div>
</div>
</div>
  
  


    </article>
  
  <ul class="pager">
    
    <li class="previous"><a href="/blog/page/3/">&larr; Older</a></li>
    
    <li><a href="/blog/archives">Blog Archives</a></li>
    
    <li class="next"><a href="/">Newer &rarr;</a></li>
    
  </ul>
</div>
<aside class="sidebar-nav span3">
  
    <section>
  <h1>About Me</h1>
  <p><img src="/images/my_avatar.jpg"></p>
  <p>网络工程师，喜欢折腾linux，emacs。</p>
  <p>坚持理想，相信一定会实现。</p>
  <p><a href="mailto:emmoblin@gmail.com"><img src="/images/my_email.png" alt="emmoblin@gmail.com"></a></p>
</section>
<section>
  <h1>Categories</h1>
    <ul id="category-list"><li><a href='/blog/categories/bodybuilding'>bodybuilding (1)</a></li><li><a href='/blog/categories/efficiency'>efficiency (1)</a></li><li><a href='/blog/categories/emacs'>emacs (3)</a></li><li><a href='/blog/categories/git'>git (2)</a></li><li><a href='/blog/categories/ipv6'>ipv6 (1)</a></li><li><a href='/blog/categories/kernel'>kernel (1)</a></li><li><a href='/blog/categories/ksplice'>ksplice (1)</a></li><li><a href='/blog/categories/libvirt'>libvirt (1)</a></li><li><a href='/blog/categories/linux'>linux (1)</a></li><li><a href='/blog/categories/linuxcmd'>linuxcmd (1)</a></li><li><a href='/blog/categories/lisp'>lisp (2)</a></li><li><a href='/blog/categories/lua'>lua (4)</a></li><li><a href='/blog/categories/markdown'>markdown (3)</a></li><li><a href='/blog/categories/nat'>nat (1)</a></li><li><a href='/blog/categories/netfilter'>netfilter (1)</a></li><li><a href='/blog/categories/network'>network (2)</a></li><li><a href='/blog/categories/octopress'>octopress (3)</a></li><li><a href='/blog/categories/open-sources'>open sources (1)</a></li><li><a href='/blog/categories/orgmode'>orgmode (1)</a></li><li><a href='/blog/categories/scm'>scm (2)</a></li><li><a href='/blog/categories/service'>service (4)</a></li><li><a href='/blog/categories/shell'>shell (4)</a></li><li><a href='/blog/categories/skill'>skill (1)</a></li><li><a href='/blog/categories/ssh'>ssh (2)</a></li><li><a href='/blog/categories/storage'>storage (3)</a></li><li><a href='/blog/categories/svn'>svn (2)</a></li><li><a href='/blog/categories/test'>test (1)</a></li><li><a href='/blog/categories/testunit'>testunit (3)</a></li><li><a href='/blog/categories/tools'>tools (13)</a></li><li><a href='/blog/categories/ubuntu'>ubuntu (4)</a></li><li><a href='/blog/categories/unittest'>unittest (3)</a></li></ul>
</section>

<section>
<h1>新浪微博</h1>
<ul id="weibo">
<li>
<iframe width="100%" height="550" class="share_self"  frameborder="0" scrolling="no" 
src="http://widget.weibo.com/weiboshow/index.php?
language=&
width=0&
height=550&
fansRow=2&
ptype=1&
speed=0&
skin=5&
isTitle=1&
noborder=1&
isWeibo=1&
isFans=0&
uid=1905507693&
verifier=e659651a&
dpc=1"></iframe>
</li>
</ul>
</section>

<section>
  <h1>近期评论</h1>
<script type="text/javascript" src="http://emmoblin.disqus.com/combination_widget.js?num_items=5&hide_mods=0&color=blue&default_tab=recent&excerpt_length=200"></script><a href="http://disqus.com/">Powered by Disqus</a>
</section>
<section class="well">
  <ul id="recent_posts" class="nav nav-list">
    <li class="nav-header">Recent Posts</li>
    
      <li class="post">
        <a href="/blog/2013/08/05/bond-mode/">bond的几种mode</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/07/25/tmux/">tmux</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/06/16/virsh-note/">virsh使用</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/06/11/nic-offload/">网卡offload</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/06/08/10/">提升软件开发者生产力的10个提示</a>
      </li>
    
  </ul>
</section>






  
</aside>

    </div>
  </div>
  <footer role="contentinfo" class="page-footer"><hr>
<p>
  Copyright &copy; 2013 - emmoblin -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
  <br> <script src="http://s25.cnzz.com/stat.php?id=5063649&web_id=5063649&online=1&show=line" language="JavaScript"></script>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'emmoblin';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>
